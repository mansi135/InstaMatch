{% extends 'base.html' %}

{% block title %}User Profile{% endblock %}

{% block head %}
    <style>
      .carousel-inner > .item > img
       {
          width: 70%;
          margin: auto;
      }
      .modal {
          display: none;
          position: fixed;
          z-index: 1;
          padding-top: 100px;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          overflow: auto;
          background-color: black;
        }
        /* Modal Content */
        .modal-content {
          position: relative;
          background-color: #fefefe;
          margin: auto;
          padding: 0;
          width: 90%;
          max-width: 1200px;
        }

        /* The Close Button */
        .close {
          color: white;
          position: absolute;
          top: 10px;
          right: 600px;
          font-size: 35px;
          font-weight: bold;
        }

        .close:hover,
        .close:focus {
          color: #999;
          text-decoration: none;
          cursor: pointer;
        }
        .cursor {
          cursor: pointer
        }
      </style>  
{% endblock %}

{% block content %}
<div class="container" style="text-align: center;">
    <h1> {{ user.fname }} {{ user.lname }} </h1>


    <br><br>
    <!-- {% for pic in user.pictures %}
        <img src="/{{ pic.picture_url }}">
    {% endfor %} -->
    <div class="row">
        <div id="personal">
            <a href="#" class="profile-pic"><img src="/{{ UPLOAD_FOLDER }}{{ user.pictures[0].picture_url }}" width="200px" height="200px" ></a>

            <div id="myCarousel" class="carousel slide modal" data-ride="carousel">
                <span class="close cursor" onclick="closeModal()">&times;</span>
                <!-- Indicators -->
                <ol class="carousel-indicators">                   
                    {% for item in user.pictures %} 
                        {% if loop.index0 == 0 %} <!-- loop.index0 is used for looping in jinja -->
                            <li data-target="#myCarousel" data-slide-to="{{ loop.index0 }}" class="active"></li>
                        {% else %}
                            <li data-target="#myCarousel" data-slide-to="{{ loop.index0 }}"></li>
                        {% endif %}
                    {% endfor %}
                </ol>

                <!-- Wrapper for slides -->
                <div class="carousel-inner modal-content" role="listbox">
                    {% for pic in user.pictures %}
                        {% if loop.index0 == 0 %}
                          <div class="item active">
                            <img src="/{{ UPLOAD_FOLDER }}{{ pic.picture_url }}" style="width:100%;">
                          </div>
                        {% else %}
                            <div class="item">
                             <img src="/{{ UPLOAD_FOLDER }}{{ pic.picture_url }}" style="width:100%;">
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>

                <!-- Left and right controls -->
                <a class="left carousel-control" href="#myCarousel" data-slide="prev">
                  <span class="glyphicon glyphicon-chevron-left"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel" data-slide="next">
                  <span class="glyphicon glyphicon-chevron-right"></span>
                  <span class="sr-only">Next</span>
                </a>
            </div>
     

            <h3>Personal Info</h3>
                <p> Gender : {{ user.personal.gender }} </p>
                <p id="dob">Date of Birth : {{ user.personal.dob }}</p>
                <p id="age"></li>
                <p> Height : {{ user.personal.height }} cm</p>
                <p> About {{ user.fname }} : {{ user.personal.aboutme }} </p>
                <p> Ethnicity : {{ user.personal.ethnicity.ethnicity_name }} </p>
                <p> Religion : {{ user.personal.religion.religion_name }} </p>  
        </div>
    </div>

    <div class="row">
        <div id="contact-info">
            <h3>Contact Info</h3>
            <ul>
                <li> Address : {{ user.contact.street_address }} </li>
                <li> City : {{ user.contact.city }} </li>
                <li> Zipcode : {{ user.contact.zipcode }} </li>
                <li> Phone Number : {{ user.contact.phone }} </li>
                <li> Email : {{ user.email }}</li>
            </ul>
        </div>
    </div>
    
    <div class="row">
        <div id="professional">
            <h3>Professional Info</h3>
            <ul>
                <li> Education : {{ user.professional.education}} </li>
                <li> Occupation : {{ user.professional.occupation}} </li>
                <li> Employer : {{ user.professional.employer}} </li>
            </ul>
            
        </div>
    </div>

    <div class="row">
        <div id="interests">
            <h3>Interests</h3>
                <ul>
                {% for interest in user.interests %}
                    <li> {{ interest.interest_name }}</li>
                {% endfor %}
                </ul>
        </div>
    </div>

    <div class="row">
        <button>Edit</button>
    </div>

</div> 

{% endblock %}

{% block javascript %}
    <script>
    function closeModal() {
          $('#myCarousel').hide();
        }
    $(document).ready(function() { 

        $('#myCarousel').hide();

        let age = calculateAge($('#dob').html()) + ' years old';  
        $('#age').html(age);

        $('.profile-pic').on('click', function() {
            $('#myCarousel').show();
        })

        

        // if(' user_type ' !== 'self') {
        //     $('#contact-info').hide();
        // } else {
        //     $('#contact-info').show();
        // }

        // status is status of any user wrt current_user
        // contact_type is the type of connection of current_user with contacted-user
        // if status === Accepted
        //     show status
        //     show contact-info
        //     show message-button
        // if status === Pending
        //     show status
        //     hide contact-info
        //     if contact_type === 'source'
        //         show accept-btn
        //         show pass-btn
        //     if contact_type === 'target'
        //         <Do nothing>
        // if status === Passed
        //     show status
        //     hide contact-info
        // if status === new
        //     hide status
        //     hide contact-info
        //     show send-request-btn
        //     show mark-fav-btn
        // if status === none (self)
        //     hide status
        //     show contact-info
        //     show edit-button

    });
    </script>

{% endblock %}